class Card{constructor(e,t){this.suit=e,this.point=t}}class Deck{constructor(){this.cards=[],this.create()}create(){var r=["diamonds","clubs","hearts","spades"];for(let t=0;t<13;t++)for(let e=0;e<4;e++)this.cards[13*e+t]=new Card(r[e],t+2)}shuffle(){for(let e=0;e<52;e++){var t=random(0,51),r=this.cards[e];this.cards[e]=this.cards[t],this.cards[t]=r}}getTopCard(){return this.cards.pop()}distribution(){for(let e=0;e<5;e++)player.cards[e]=deck.getTopCard()}}class Player{constructor(e,t){this.name=e,this.dollars=t,this.currentBet=1e4,this.cards=[]}}function random(e,t){t=e+Math.random()*(t+1-e);return Math.floor(t)}function setStartValues(){player=new Player("Player",5e4),refresh(),newDistribution=!0,balance.innerHTML=5e4,switchBetLine(1);for(var e of holdButtons)e.classList.add("disabled")}function checkCombination(){sortByPoints(),sortBySuits();let e=0,t={name:"nothing",id:0};for(;e<4&&player.cards[e].suit===player.cards[e+1].suit;)e++;if(4===e&&(t.name="flush",t.id=5,14===player.cards[4].point&&10===player.cards[0].point))return t.name="royal flush",t.id=9,t;for(sortByPoints(),e=0;e<4&&player.cards[e].point===player.cards[e+1].point-1;)e++;if(4===e)return"flush"===t.name?(t.name="straight flush",t.id=8):(t.name="straight",t.id=4),t;var r=getCountOfDuplicates();let s=Object.values(r);if(s.includes(4))return t.name="four of a kind",t.id=7,t;if(s.includes(3))return s.includes(2)?(t.name="full house",t.id=6):(t.name="three of a kind",t.id=3),t;if("flush"===t.name||"straight"===t.name)return t;if(2===s.filter(e=>2===e).length)return t.name="two pairs",t.id=2,t;for(let e=4;0<e;e--)if(player.cards[e].point===player.cards[e-1].point&&10<player.cards[e].point)return t.name="jacks or better",t.id=1,t;return t}function sortByPoints(){player.cards.sort((e,t)=>e.point-t.point)}function sortBySuits(){player.cards.sort((e,t)=>e.suit.localeCompare(t.suit))}function getCountOfDuplicates(){return player.cards.reduce((e,t)=>(e[t.point]=e[t.point]?e[t.point]+1:1,e),{})}const cards=document.querySelectorAll(".card");function cardRender(e){var t,r,s=cards[e].querySelectorAll(".point"),n=cards[e].querySelectorAll(".suit"),a=getHTMLpoint(e),i=getHTMLsuit(e),o=getSuitColor(e);for(t of s)t.innerHTML=a,"red"===o?t.classList.add("red"):t.classList.remove("red");for(r of n)r.setAttribute("src","images/icons/"+i)}function getHTMLsuit(e){switch(player.cards[e].suit){case"clubs":return"club.svg";case"diamonds":return"diamond.svg";case"hearts":return"heart.svg";case"spades":return"spade.svg"}}function getHTMLpoint(e){switch(player.cards[e].point){case 10:return"=";case 11:return"J";case 12:return"Q";case 13:return"K";case 14:return"A";default:return player.cards[e].point}}function getSuitColor(e){return"diamonds"===player.cards[e].suit||"hearts"===player.cards[e].suit?"red":"black"}function changeCards(){if(5!==holdingCards.length){for(let e=0;e<5;e++)holdingCards.includes(e)||(cards[e].classList.remove("flip"),setTimeout(()=>{player.cards[e]=deck.getTopCard(),cardRender(e)},200));setTimeout(()=>{for(let e=0;e<5;e++)flipCard(e)},500)}}function flipCard(e){setTimeout(()=>{cards[e].classList.add("flip")},200)}function flipCardsBack(){for(let e=0;e<5;e++)cards[e].classList.remove("flip")}const combinationTable=document.querySelector(".combinations");function highlightWinningCell(e,t){0!==e.id&&combinationTable.rows[9-e.id].cells[t].classList.add("winning")}function switchBetLine(e){for(var t of combinationTable.rows)for(var r of t.cells)r.classList.remove("active-line");for(var s of combinationTable.rows)s.cells[e].classList.add("active-line")}function refreshControlButtons(){for(var e of holdButtons)e.classList.remove("active");holdingCards.length=0}function refreshCells(){for(var e of combinationTable.rows)for(var t of e.cells)t.classList.remove("winning")}function refresh(){refreshControlButtons(),refreshCells(),flipCardsBack()}const balance=document.querySelector(".balance");function calculateResult(e,t){let r=0;if(0===e.id)for(r=-player.currentBet,player.dollars-=player.currentBet;betSlides[currentIndex].textContent>player.dollars&&0<currentIndex;)showBet(currentIndex-1),switchBetLine(currentIndex+1);else{e=combinationTable.rows[9-e.id].cells[t].textContent;r=player.currentBet*e-player.currentBet,player.dollars+=r}balance.innerHTML=player.dollars,setTimeout(()=>showResult(r),400),checkBankruptcy()}function checkBankruptcy(){0===player.dollars&&showModal()}const restartModal=document.querySelector(".over-modal"),restartBtn=document.querySelector(".restart");function showModal(){setTimeout(()=>restartModal.classList.add("active"),2300)}restartBtn.addEventListener("click",()=>{restartModal.classList.remove("active"),startGame()});const payout=document.querySelector(".payout"),payoutText=document.querySelector(".payout .text"),payoutNumber=document.querySelector(".payout .number");function showResult(e){payoutText.innerHTML=0<=e?"Payout:":"You lose:",payoutNumber.innerHTML="$"+Math.abs(e),payout.classList.add("active"),setTimeout(()=>payout.classList.remove("active"),1500)}const betSlides=document.querySelectorAll(".bet-item");let currentIndex=0;function showBet(e){betSlides[currentIndex].classList.remove("active"),betSlides[e].classList.add("active"),player.currentBet=betSlides[e].textContent,currentIndex=e}let prevSlideBtn=document.querySelector(".bet-prev"),nextSlideBtn=document.querySelector(".bet-next"),holdingCards=(prevSlideBtn.addEventListener("click",()=>{0<currentIndex&&(showBet(currentIndex-1),switchBetLine(currentIndex+1))}),nextSlideBtn.addEventListener("click",()=>{currentIndex<betSlides.length-1&&player.dollars>=betSlides[currentIndex+1].textContent&&(showBet(currentIndex+1),switchBetLine(currentIndex+1))}),[]),holdButtons=[...document.querySelectorAll(".hold-button")];for(let e of holdButtons)e.addEventListener("click",function(){var e=holdButtons.indexOf(this);this.classList.toggle("active"),holdingCards.includes(e)?holdingCards.splice(holdingCards.indexOf(e),1):holdingCards.push(e)});let dealBtn=document.querySelector(".deal-button"),newDistribution=!0;dealBtn.addEventListener("click",function(){this.classList.add("disabled"),setTimeout(()=>this.classList.remove("disabled"),1600),newDistribution=newDistribution?(refresh(),newRound(),!1):(changeCards(),setTimeout(()=>{let e=checkCombination();setTimeout(()=>highlightWinningCell(e,currentIndex+1),400),calculateResult(e,currentIndex+1)},1e3),!0);for(var e of holdButtons)e.classList.toggle("disabled");prevSlideBtn.classList.toggle("disabled"),nextSlideBtn.classList.toggle("disabled")});let deck,player;function newRound(){setTimeout(()=>{(deck=new Deck).shuffle(),deck.distribution();for(let e=0;e<5;e++)cardRender(e),setTimeout(()=>flipCard(e),200)},300)}function startGame(){setStartValues()}startGame();